# 성능과 최적화
- 성능 분석은 것은 경험주의와 질퍽한 인간 심리학이 교묘히 어우러진 분야이다.
## 자바 성능 : 잘못된방법
- 옛날의 자바는 디스패치(메서드호출) 성능이 최악이어서 메서드 하나에 크게 로직을 넣어 두는것이 좋다고 권고하는 사람들이 많았다.
  - 이런 방식은 코드를 이해하기 어렵게 만들고, 유지보수를 어렵게 만든다.
  - 현대의 JVM은 자동 인라이닝을 통해서 가상 디스패치조차 대부분의 호출부에서 사라지게 됬다.
> JVM을 더 빨리 작동시키는 '마법의 스위치는 없다.'  
> 자바를 더 빨리 실행하게 만드는 '팁,트릭'은 없다.  
> 사용자가 못 보게 꼭꼭 숨겨둔 '비밀 알고리즘'도 없다.

## 자바 성능 개요
> 자바는 블루 칼라(주로 생산직에 종사하는 육체 노동자) 언어 입니다. 박사 학위 논문 주제가 아니라 일을 하려고 만든 언어죠 - 제임스 고슬링
- 자바가 최근들어 고성능 컴퓨팅 애플리케이션에 적합한 수준에 이르게 된건 핫스팟,GraalVM과 같은 가상머신의 발전 덕분이다.
- 자바 플랫폼은 실용주의로 대표적인 것은 서브시스템이다.
  - 예를들어 메모리 관리가 그렇다 JVM이 알아서 메모리를 관리해주기 때문에 개발자는 메모리 관리를 신경쓰지 않아도 된다.
### 불편한 진실
- JVM 애플리케이션을 측정해보면 성능 측정값이 정규 분포를 따르지 않는 경우가 많다. 때문에 기초 통계로 측정결과를 추측하기는 힘들다.
  - 예를 들어 저지연 애플리케이션에서 특히 특이점은 매우 중요한 의미를 내포하는데 측정값을 샘플링하면 특이점을 일으킨 중요한 이벤트가 묻힐가능성이 크다.
  - 즉 작은 포인트가 중요하지만 평균적인 성능 측정값을 가지고는 정확한 결론을 내리기 어렵다.
  - 이러한 것들을 보아 자바의 측정값 때문에 판단이 흐려지기 쉽기 때문에 항상 주의 해야한다.
  - 측정 행위 자체도 오버헤드를 일으키며 자주 샘플링하거나 하면 성능 결과에 영향을 준다.
    - 예를 들어 yourkit 같은 프로파일러를 이용해서 측정을 할 때 이는 꽤 큰 리소스를 소비하는데 성능 측정과 함께 할 경우 제대로된 성능측정을 하기 힘들 수 있다.

## 성능은 실험과학이다.
- JVM의 성능튜닝을 하기위해 해야하는 단계
  1. 성능 목표를 설정한다.(원하는 결과 정의)
  2. 기존 시스템을 측정한다.
  3. 요건을 충족시키려면 무슨 일을 해야 하는지 결정한다.
  4. 개선 활동을 추진한다.
  5. 다시 측정한다.
  6. 목표를 달성했는지 확인한다.

> 즉 성능 분석은 닭을 해부해보거나 점을 치는 과정이 아니라, 통계치에 근거해 적절히 결과를 처리하는 활동이다.

## 성능분류
가장 기본적인 성능지표 7가지
- 처리율(throughput) : 단위 시간당 수행가능한 작업 비율
  - 예시 초당 처리가능한 트랜잭션 수 TPS
  - 이 지표가 의미있는 데이터가 되기위해서는 해당 수치를 얻은 플랫폼에 대해서 기술을 해야한다. (현재 컴퓨터 스펙, OS, 테스트 시스템 클러스터 유무 등등 )
  - 또 트랜잭션은 테스트 할때 마다 동일해야한다.
- 지연(latency) : 하나의 트랜잭션의 수행 소요 시간
- 사용률(utilization) :
- 용량(capacity) :
- 효율(efficiency) :
- 확장성(scalability) :
- 저하 :
